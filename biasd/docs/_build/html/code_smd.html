

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>SMD &mdash; BIASD v0.1</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="BIASD v0.1" href="index.html"/>
        <link rel="next" title="Utils" href="code_utils.html"/>
        <link rel="prev" title="MCMC" href="code_mcmc.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> BIASD</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="getstarted.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getstarted.html#biasd-mcmc">BIASD + MCMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="getstarted.html#plot-biasd-mcmc-results-using-corner">Plot BIASD-MCMC Results Using Corner</a></li>
<li class="toctree-l2"><a class="reference internal" href="getstarted.html#plot-biasd-mcmc-results-using-viewer">Plot BIASD-MCMC Results Using Viewer</a></li>
<li class="toctree-l2"><a class="reference internal" href="getstarted.html#biasd-laplace-approximation">BIASD + Laplace Approximation</a></li>
<li class="toctree-l2"><a class="reference internal" href="getstarted.html#my-baseline-and-biasd">My Baseline and BIASD...</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="compileguide.html">Compiling the Likelihood</a><ul>
<li class="toctree-l2"><a class="reference internal" href="compileguide.html#background">Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="compileguide.html#how-to-compile">How to Compile</a></li>
<li class="toctree-l2"><a class="reference internal" href="compileguide.html#testing-speed">Testing Speed</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="code_distributions.html">Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="code_distributions.html#module-distributions">Some standard probability distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_distributions.html#convert-between-distributions">Convert between distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_distributions.html#distributions-can-be-collected-for-priors-or-posteriors">Distributions can be collected for priors or posteriors</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_distributions.html#collections-can-be-visualized">Collections can be visualized</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_distributions.html#module-distributions">Finally, you can easily generate a few useful collections using</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="code_laplace.html">Laplace</a><ul>
<li class="toctree-l2"><a class="reference internal" href="code_laplace.html#laplace-approximation">Laplace Approximation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="code_likelihood.html">Likelihood</a><ul>
<li class="toctree-l2"><a class="reference internal" href="code_likelihood.html#switch-the-log-likelihood-function">Switch the log-likelihood function</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_likelihood.html#module-likelihood">Inference-related functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="code_mcmc.html">MCMC</a><ul>
<li class="toctree-l2"><a class="reference internal" href="code_mcmc.html#markov-chain-monte-carlo">Markov chain Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_mcmc.html#module-mcmc">Setup and Run MCMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_mcmc.html#module-mcmc">Analyze MCMC samples</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SMD</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-smd">Work with SMD data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-smd.add">Add BIASD results to an SMD object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-smd.read">Read BIASD results from an SMD object into a useful format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="code_utils.html">Utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="code_utils.html#id1">Utils</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">BIASD</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>SMD</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/code_smd.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="smd">
<span id="code-smd"></span><h1>SMD<a class="headerlink" href="#smd" title="Permalink to this headline">¶</a></h1>
<p>This page gives the details about the code in biasd.smd.</p>
<p>The Single-Molecule Dataset (SMD) format is a standardized data format for use in time-resolved, single-molecule experiments (e.g, smFRET, force spectroscopy, etc.). It was published in collaboration between the <a class="reference external" href="http://www.columbia.edu/cu/chemistry/groups/gonzalez/index.html">Gonzalez</a> and <a class="reference external" href="http://cmgm.stanford.edu/herschlag/">Herschlag</a> labs (Greenfield, M <em>et al</em>. <em>BMC Bioinformatics</em> <strong>2015</strong>, <em>16</em>, 3. <a class="reference external" href="http://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-014-0429-4">DOI: 10.1186/s12859-014-0429-4</a>). A github page with some <a class="reference external" href="https://smdata.github.io">Matlab</a> and <a class="reference external" href="https://github.com/smdata/smd-python">Python</a> code exists.</p>
<div class="section" id="module-smd">
<span id="work-with-smd-data"></span><h2>Work with SMD data<a class="headerlink" href="#module-smd" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="smd.new">
<code class="descclassname">smd.</code><code class="descname">new</code><span class="sig-paren">(</span><em>time</em>, <em>data</em>, <em>channel_names=None</em><span class="sig-paren">)</span><a class="headerlink" href="#smd.new" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new SMD structure. The structure is:</p>
<dl class="docutils">
<dt>SMD:</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>.attr </dt>
<dd><ul class="first last simple">
<li>.many</li>
<li>.items</li>
<li>.here</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>.data <code class="docutils literal"><span class="pre">(this</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">list)</span></code></dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>[0] <code class="docutils literal"><span class="pre">(trace</span> <span class="pre">0)</span></code></dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>.attr <code class="docutils literal"><span class="pre">(BIASD</span> <span class="pre">saves</span> <span class="pre">data</span> <span class="pre">in</span> <span class="pre">here)</span></code></dt>
<dd><ul class="first last simple">
<li>.many</li>
<li>.here</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">.id <code class="docutils literal"><span class="pre">(a</span> <span class="pre">unique</span> <span class="pre">number)</span></code></p>
</li>
<li><p class="first">.index <code class="docutils literal"><span class="pre">(time</span> <span class="pre">array)</span></code></p>
</li>
<li><dl class="first docutils">
<dt>.values <code class="docutils literal"><span class="pre">(signal</span> <span class="pre">data</span> <span class="pre">is</span> <span class="pre">in</span> <span class="pre">here)</span></code></dt>
<dd><ul class="first last simple">
<li>.channel_1 <code class="docutils literal"><span class="pre">(e.g.</span> <span class="pre">Cy3)</span></code></li>
<li>.channel_2</li>
<li>.channel_etc</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>[1] <code class="docutils literal"><span class="pre">(trace</span> <span class="pre">1)</span></code></dt>
<dd><ul class="first last simple">
<li>...</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">...</p>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>.id <code class="docutils literal"><span class="pre">(a</span> <span class="pre">unique</span> <span class="pre">number)</span></code></dt>
<dd></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>.types <code class="docutils literal"><span class="pre">(the</span> <span class="pre">datatypes</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">entries</span> <span class="pre">in</span> <span class="pre">values)</span></code></dt>
<dd></dd>
</dl>
</li>
</ul>
</dd>
<dt>Input:</dt>
<dd><ul class="first simple">
<li><cite>time</cite> is an <cite>np.ndarray</cite> of length T (number of datapoints). It marks the indexing time for each data point.</li>
<li><cite>data</cite> is an NxDxT <cite>np.ndarray</cite>, because that ordering is consistent with original SMD...</li>
</ul>
<dl class="docutils">
<dt>where: </dt>
<dd><ul class="first last simple">
<li>N: number traces</li>
<li>D: data dimensionality i.e. number of channels</li>
<li>T: number of time points</li>
</ul>
</dd>
</dl>
<ul class="last simple">
<li><cite>channel_names</cite> is a list of strings, e.g. [&#8220;Cy3&#8221;,&#8221;Cy5&#8221;] of length D</li>
</ul>
</dd>
<dt>Returns:</dt>
<dd><ul class="first last simple">
<li>an SMD object</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smd.load">
<code class="descclassname">smd.</code><code class="descname">load</code><span class="sig-paren">(</span><em>filename</em>, <em>JSON=False</em>, <em>conversion=&lt;function _conversion_default&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#smd.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an SMD file saved in JSON format into Python
Input:</p>
<blockquote>
<div><ul class="simple">
<li><cite>filename</cite> is a str with the path the SMD file you wish to open</li>
</ul>
</div></blockquote>
<dl class="docutils">
<dt>Returns:</dt>
<dd><ul class="first last simple">
<li>SMD in Python object form</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smd.save">
<code class="descclassname">smd.</code><code class="descname">save</code><span class="sig-paren">(</span><em>filename</em>, <em>smd</em><span class="sig-paren">)</span><a class="headerlink" href="#smd.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save your SMD file. This has to save as JSON.... so all numpy things are turned into lists...
Input:</p>
<blockquote>
<div><ul class="simple">
<li><cite>filename</cite> is the output filename to save</li>
<li><cite>smd</cite> is an SMD object that will be saved in <cite>filename</cite></li>
</ul>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-smd.add">
<span id="add-biasd-results-to-an-smd-object"></span><h2>Add BIASD results to an SMD object<a class="headerlink" href="#module-smd.add" title="Permalink to this headline">¶</a></h2>
<p>Add a BIASD result to an SMD file. This includes functions for <cite>prior collections</cite>, <cite>posterior collections</cite>, <cite>Laplace posteriors</cite>, <cite>baseline corrections</cite>, and <cite>MCMC results</cite>.</p>
<dl class="docutils">
<dt>Input:</dt>
<dd><ul class="first last simple">
<li><cite>smd</cite> is the input SMD object where the data will be added</li>
<li><cite>i</cite> is the number of the molecule to which to add the data</li>
<li><cite>final argument</cite> is the data that will be added</li>
</ul>
</dd>
<dt>Returns:</dt>
<dd><ul class="first last simple">
<li><cite>smd</cite> is an updated SMD object</li>
</ul>
</dd>
</dl>
<dl class="function">
<dt id="smd.add.baseline">
<code class="descclassname">smd.add.</code><code class="descname">baseline</code><span class="sig-paren">(</span><em>smd</em>, <em>i</em>, <em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#smd.add.baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Baseline result from biasd.utils.baseline</p>
</dd></dl>

<dl class="function">
<dt id="smd.add.laplace_posterior">
<code class="descclassname">smd.add.</code><code class="descname">laplace_posterior</code><span class="sig-paren">(</span><em>smd</em>, <em>i</em>, <em>lp</em><span class="sig-paren">)</span><a class="headerlink" href="#smd.add.laplace_posterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Laplace posterior from biasd.laplace</p>
</dd></dl>

<dl class="function">
<dt id="smd.add.mcmc">
<code class="descclassname">smd.add.</code><code class="descname">mcmc</code><span class="sig-paren">(</span><em>smd</em>, <em>i</em>, <em>sampler</em><span class="sig-paren">)</span><a class="headerlink" href="#smd.add.mcmc" title="Permalink to this definition">¶</a></dt>
<dd><p>MCMC Result from biasd.mcmc</p>
</dd></dl>

<dl class="function">
<dt id="smd.add.posterior">
<code class="descclassname">smd.add.</code><code class="descname">posterior</code><span class="sig-paren">(</span><em>smd</em>, <em>i</em>, <em>posterior</em><span class="sig-paren">)</span><a class="headerlink" href="#smd.add.posterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Posterior distribution collection from biasd.distributions</p>
</dd></dl>

<dl class="function">
<dt id="smd.add.priors">
<code class="descclassname">smd.add.</code><code class="descname">priors</code><span class="sig-paren">(</span><em>smd</em>, <em>i</em>, <em>priors</em><span class="sig-paren">)</span><a class="headerlink" href="#smd.add.priors" title="Permalink to this definition">¶</a></dt>
<dd><p>Piror distribution collection from biasd.distributions</p>
</dd></dl>

</div>
<div class="section" id="module-smd.read">
<span id="read-biasd-results-from-an-smd-object-into-a-useful-format"></span><h2>Read BIASD results from an SMD object into a useful format<a class="headerlink" href="#module-smd.read" title="Permalink to this headline">¶</a></h2>
<p>Read a BIASD result from an SMD file into a useful format. This includes functions for <cite>prior collections</cite>, <cite>posterior collections</cite>, <cite>Laplace posteriors</cite>, <cite>baseline corrections</cite>, and <cite>MCMC results</cite>.</p>
<dl class="docutils">
<dt>Input:</dt>
<dd><ul class="first last simple">
<li><cite>smd</cite> is the input SMD object from where the data will be read</li>
<li><cite>i</cite> is the number of the molecule to from which to read the data</li>
</ul>
</dd>
</dl>
<dl class="function">
<dt id="smd.read.baseline">
<code class="descclassname">smd.read.</code><code class="descname">baseline</code><span class="sig-paren">(</span><em>smd</em>, <em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#smd.read.baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a baseline calculation from an SMD.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd><ul class="first last simple">
<li>a <cite>biasd.utils.baseline.params</cite></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smd.read.laplace_posterior">
<code class="descclassname">smd.read.</code><code class="descname">laplace_posterior</code><span class="sig-paren">(</span><em>smd</em>, <em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#smd.read.laplace_posterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a Laplace posterior object from an SMD.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd><ul class="first last simple">
<li>a <cite>biasd.laplace._laplace_posterior</cite></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smd.read.mcmc">
<code class="descclassname">smd.read.</code><code class="descname">mcmc</code><span class="sig-paren">(</span><em>smd</em>, <em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#smd.read.mcmc" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a BIASD MCMC result from an SMD.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd><ul class="first last simple">
<li>a <cite>biasd.smd.read.mcmc.mcmc_result</cite></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smd.read.posterior">
<code class="descclassname">smd.read.</code><code class="descname">posterior</code><span class="sig-paren">(</span><em>smd</em>, <em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#smd.read.posterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a BIASD posterior distribution collection from an SMD.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd><ul class="first last simple">
<li>a <cite>biasd.distributions.parameter_collection</cite></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smd.read.priors">
<code class="descclassname">smd.read.</code><code class="descname">priors</code><span class="sig-paren">(</span><em>smd</em>, <em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#smd.read.priors" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a BIASD prior distribution collection from an SMD.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd><ul class="first last simple">
<li>a <cite>biasd.distributions.parameter_collection</cite></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Create, add, and save example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">biasd</span> <span class="kn">as</span> <span class="nn">b</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c"># Load the data</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="n">tau</span><span class="p">)</span>
<span class="n">cy3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&#39;my_cy3_data.dat&#39;</span><span class="p">)</span>
<span class="n">cy5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&#39;my_cy5_data.dat&#39;</span><span class="p">)</span>
<span class="n">fret</span> <span class="o">=</span> <span class="n">d1</span><span class="o">/</span><span class="p">(</span><span class="n">d1</span><span class="o">+</span><span class="n">d2</span><span class="p">)</span>

<span class="c"># Structure the data into NxDxT</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">cy3</span><span class="p">,</span><span class="n">cy5</span><span class="p">,</span><span class="n">fret</span><span class="p">))</span>

<span class="c"># Make a new SMD</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">smd</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">d</span><span class="p">,[</span><span class="s">&#39;Cy3&#39;</span><span class="p">,</span><span class="s">&#39;Cy5&#39;</span><span class="p">,</span><span class="s">&#39;FRET&#39;</span><span class="p">])</span>

<span class="c"># Setup the priors</span>
<span class="n">e1</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">9.</span><span class="p">)</span>
<span class="n">e2</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mf">9.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="o">/.</span><span class="mo">05</span><span class="p">)</span>
<span class="n">k1</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mf">20.</span><span class="p">,</span><span class="mf">20.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span>
<span class="n">k2</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mf">20.</span><span class="p">,</span><span class="mf">20.</span><span class="o">/</span><span class="mf">8.</span><span class="p">)</span>
<span class="n">priors</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">parameter_collection</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span><span class="n">e2</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">k1</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span>

<span class="c"># Loop over all the molecules</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">n_traces</span><span class="p">):</span>

        <span class="c"># Add the priors, and Laplace posterior results</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">smd</span><span class="o">.</span><span class="n">add_priors</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">priors</span><span class="p">)</span>

        <span class="c"># Do a long calculations and add those results...</span>

        <span class="c"># Save the results as we go in case of a crash</span>
        <span class="n">b</span><span class="o">.</span><span class="n">smd</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;data.smd&#39;</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>Load, and read example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">biasd</span> <span class="kn">as</span> <span class="nn">b</span>

<span class="c"># Load the SMD</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">smd</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;data.smd&#39;</span><span class="p">)</span>

<span class="c"># Read the priors for the first molecule (0)</span>
<span class="n">priors</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">smd</span><span class="o">.</span><span class="n">read_priors</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="c"># Read the Laplace posterior object for the first molecule (0)</span>
<span class="n">lp</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">smd</span><span class="o">.</span><span class="n">read_laplace_posterior</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="c"># Read the MCMC rsults for the first molecule (0)</span>
<span class="n">mcmc_results</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">smd</span><span class="o">.</span><span class="n">read_mcmc</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="code_utils.html" class="btn btn-neutral float-right" title="Utils">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="code_mcmc.html" class="btn btn-neutral" title="MCMC"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Colin Kinz-Thompson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>